 Testing init_tree
 Testing init_geometry
 Testing i_node_new()
 Testing set_tree_root
 after set_tree_root
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0   -100   -100      0     30      1      1      1   -100   -100   -100
      2      1      0   -100   -100      0     30      2      1      1   -100   -100   -100
      3      1      0   -100   -100      0     30      3      1      1   -100   -100   -100
      4      1      0   -100   -100      0     30      1      2      1   -100   -100   -100
      5      1      0   -100   -100      0     30      2      2      1   -100   -100   -100
      6      1      0   -100   -100      0     30      3      2      1   -100   -100   -100
 Testing find_tree_node
 Testing distribute_tree 1st
 after distribute_tree 1st
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      1      1      0     30      1      2      1   -100   -100   -100
      5      1      0      1      2      0     30      2      2      1   -100   -100   -100
      6      1      0      1      3      0     30      3      2      1   -100   -100   -100
 nNode, nNodeUsed, nBlock= 6 6 3
 iNodeMorton_I = 1 2 3 4 5 6
 iMortonNode_A = 1 2 3 4 5 6
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 Testing refine_tree_node
 Testing distribute_tree 2nd
 after distribute_tree with type=level
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      1      1      0     30      3      1      1   -100   -100   -100
      4      1      0      1      2      0     30      1      2      1   -100   -100   -100
      5      1      0      1      3      0     30      2      2      1   -100   -100   -100
      6     -1      0   -100   -100      0     30      3      2      1   -100      7      8
      7      1      1      0      3      0     30      5      2      1      6   -100   -100
      8      1      1      1      4      0     30      6      2      1      6   -100   -100
 nNode, nNodeUsed, nBlock= 8 7 3
 iNodeMorton_I = 1 2 3 4 5 7 8
 iMortonNode_A = 1 2 3 4 5 -100 6 7
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 after distribute_tree with type=Coord2
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      1      1      0     30      2      1      1   -100   -100   -100
      3      1      0      1      2      0     30      3      1      1   -100   -100   -100
      4      1      0      0      2      0     30      1      2      1   -100   -100   -100
      5      1      0      0      3      0     30      2      2      1   -100   -100   -100
      6     -1      0   -100   -100      0     30      3      2      1   -100      7      8
      7      1      1      1      3      0     30      5      2      1      6   -100   -100
      8      1      1      1      4      0     30      6      2      1      6   -100   -100
 nNode, nNodeUsed, nBlock= 8 7 3
 iNodeMorton_I = 1 2 3 4 5 7 8
 iMortonNode_A = 1 2 3 4 5 -100 6 7
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 after distribute_tree 2nd
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      1      1      0     30      1      2      1   -100   -100   -100
      5      1      0      1      2      0     30      2      2      1   -100   -100   -100
      6     -1      0   -100   -100      0     30      3      2      1   -100      7      8
      7      1      1      1      3      0     30      5      2      1      6   -100   -100
      8      1      1      1      4      0     30      6      2      1      6   -100   -100
 nNode, nNodeUsed, nBlock= 8 7 3
 iNodeMorton_I = 1 2 3 4 5 7 8
 iMortonNode_A = 1 2 3 4 5 -100 6 7
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 nRoot= 6
 after another refine_tree_node
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2     -2      0      0      2      0     30      2      1      1   -100      9     10
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      1      1      0     30      1      2      1   -100   -100   -100
      5      1      0      1      2      0     30      2      2      1   -100   -100   -100
      6     -1      0   -100   -100      0     30      3      2      1   -100      7      8
      7      1      1      1      3      0     30      5      2      1      6   -100   -100
      8      1      1      1      4      0     30      6      2      1      6   -100   -100
      9      2      1      0      2      0     30      3      1      1      2   -100   -100
     10      2      1      0      2      0     30      4      1      1      2   -100   -100
 Testing coarsen_tree_node
 after coarsen_tree_node
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2     -2      0      0      2      0     30      2      1      1   -100      9     10
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      1      1      0     30      1      2      1   -100   -100   -100
      5      1      0      1      2      0     30      2      2      1   -100   -100   -100
      6      4      0   -100   -100      0     30      3      2      1   -100      7      8
      7     -4      1      1      3      0     30      5      2      1      6   -100   -100
      8     -4      1      1      4      0     30      6      2      1      6   -100   -100
      9      2      1      0      2      0     30      3      1      1      2   -100   -100
     10      2      1      0      2      0     30      4      1      1      2   -100   -100
 Testing distribute_tree 3rd
 after distribute_tree 3rd
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2     -1      0   -100   -100      0     30      2      1      1   -100      7      8
      3      1      0      1      1      0     30      3      1      1   -100   -100   -100
      4      1      0      1      2      0     30      1      2      1   -100   -100   -100
      5      1      0      1      3      0     30      2      2      1   -100   -100   -100
      6      1      0      1      4      0     30      3      2      1   -100   -100   -100
      7      1      1      0      2      0     30      3      1      1      2   -100   -100
      8      1      1      0      3      0     30      4      1      1      2   -100   -100
 nNode, nNodeUsed, nBlock= 8 7 3
 iNodeMorton_I = 1 7 8 3 4 5 6
 iMortonNode_A = 1 -100 4 5 6 7 2 3
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 -1
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 7
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 Testing write_tree_file
 Testing read_tree_file
 after read_tree
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2     -1      0   -100   -100      0     30      2      1      1   -100      7      8
      3      1      0      1      1      0     30      3      1      1   -100   -100   -100
      4      1      0      1      2      0     30      1      2      1   -100   -100   -100
      5      1      0      1      3      0     30      2      2      1   -100   -100   -100
      6      1      0      1      4      0     30      3      2      1   -100   -100   -100
      7      1      1      0      2      0     30      3      1      1      2   -100   -100
      8      1      1      0      3      0     30      4      1      1      2   -100   -100
 Testing distribute_tree 4th
 after distribute_tree 4th
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2     -1      0   -100   -100      0     30      2      1      1   -100      7      8
      3      1      0      1      1      0     30      3      1      1   -100   -100   -100
      4      1      0      1      2      0     30      1      2      1   -100   -100   -100
      5      1      0      1      3      0     30      2      2      1   -100   -100   -100
      6      1      0      1      4      0     30      3      2      1   -100   -100   -100
      7      1      1      0      2      0     30      3      1      1      2   -100   -100
      8      1      1      0      3      0     30      4      1      1      2   -100   -100
 nNode, nNodeUsed, nBlock= 8 7 3
 iNodeMorton_I = 1 7 8 3 4 5 6
 iMortonNode_A = 1 -100 4 5 6 7 2 3
 IsPeriodic_D = T T F
 DiLevelNei_IIIB(:,0,0,First)= 0 0 -1
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= -100 0 -100
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 7
 iNodeNei_IIIB(1,:,1,  First)= 4 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= -100 1 1 -100
 Testing clean_tree
 MaxNode= 0
 Testing init_grid
 nDimAmr, nIJK_D= 1 8 4 2
 After distribute_tree
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3     -1      0   -100   -100      0     30      3      1      1   -100      7      8
      4      1      0      1      2      0     30      1      2      1   -100   -100   -100
      5      1      0      1      3      0     30      2      2      1   -100   -100   -100
      6      1      0      1      4      0     30      3      2      1   -100   -100   -100
      7      1      1      0      3      0     30      5      1      1      3   -100   -100
      8      1      1      1      1      0     30      6      1      1      3   -100   -100
 Testing create_grid
 show_grid_block for iProc, iBlock= 0 1
 CoordMin  =   3.0000000000000000   2.0000000000000000   1.0000000000000000
 CoordMax  =   5.0000000000000000   4.0000000000000000   4.0000000000000000
 CellSize  =   0.2500000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.3750000000000000   0.1250000000000000
 CellVolume=   0.1875000000000000
 Xyz( 1, 1, 1)=   3.1250000000000000   2.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   4.8750000000000000   2.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   3.1250000000000000   3.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   3.1250000000000000   2.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   4.8750000000000000   3.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 0 2
 CoordMin  =   5.0000000000000000   2.0000000000000000   1.0000000000000000
 CoordMax  =   7.0000000000000000   4.0000000000000000   4.0000000000000000
 CellSize  =   0.2500000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.3750000000000000   0.1250000000000000
 CellVolume=   0.1875000000000000
 Xyz( 1, 1, 1)=   5.1250000000000000   2.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   6.8750000000000000   2.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   5.1250000000000000   3.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   5.1250000000000000   2.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   6.8750000000000000   3.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 0 3
 CoordMin  =   7.0000000000000000   2.0000000000000000   1.0000000000000000
 CoordMax  =   8.0000000000000000   4.0000000000000000   4.0000000000000000
 CellSize  =   0.1250000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.1875000000000000   6.2500000000000000E-02
 CellVolume=   9.3750000000000000E-02
 Xyz( 1, 1, 1)=   7.0625000000000000   2.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   7.9375000000000000   2.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   7.0625000000000000   3.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   7.0625000000000000   2.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   7.9375000000000000   3.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 1 1
 CoordMin  =   8.0000000000000000   2.0000000000000000   1.0000000000000000
 CoordMax  =   9.0000000000000000   4.0000000000000000   4.0000000000000000
 CellSize  =   0.1250000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.1875000000000000   6.2500000000000000E-02
 CellVolume=   9.3750000000000000E-02
 Xyz( 1, 1, 1)=   8.0625000000000000   2.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   8.9375000000000000   2.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   8.0625000000000000   3.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   8.0625000000000000   2.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   8.9375000000000000   3.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 1 2
 CoordMin  =   3.0000000000000000   4.0000000000000000   1.0000000000000000
 CoordMax  =   5.0000000000000000   6.0000000000000000   4.0000000000000000
 CellSize  =   0.2500000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.3750000000000000   0.1250000000000000
 CellVolume=   0.1875000000000000
 Xyz( 1, 1, 1)=   3.1250000000000000   4.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   4.8750000000000000   4.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   3.1250000000000000   5.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   3.1250000000000000   4.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   4.8750000000000000   5.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 1 3
 CoordMin  =   5.0000000000000000   4.0000000000000000   1.0000000000000000
 CoordMax  =   7.0000000000000000   6.0000000000000000   4.0000000000000000
 CellSize  =   0.2500000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.3750000000000000   0.1250000000000000
 CellVolume=   0.1875000000000000
 Xyz( 1, 1, 1)=   5.1250000000000000   4.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   6.8750000000000000   4.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   5.1250000000000000   5.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   5.1250000000000000   4.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   6.8750000000000000   5.7500000000000000   3.2500000000000000
 show_grid_block for iProc, iBlock= 1 4
 CoordMin  =   7.0000000000000000   4.0000000000000000   1.0000000000000000
 CoordMax  =   9.0000000000000000   6.0000000000000000   4.0000000000000000
 CellSize  =   0.2500000000000000   0.5000000000000000   1.5000000000000000
 CellFace  =   0.7500000000000000   0.3750000000000000   0.1250000000000000
 CellVolume=   0.1875000000000000
 Xyz( 1, 1, 1)=   7.1250000000000000   4.2500000000000000   1.7500000000000000
 Xyz(nI, 1, 1)=   8.8750000000000000   4.2500000000000000   1.7500000000000000
 Xyz( 1,nJ, 1)=   7.1250000000000000   5.7500000000000000   1.7500000000000000
 Xyz( 1, 1,nK)=   7.1250000000000000   4.2500000000000000   3.2500000000000000
 Xyz(nI,nJ,nK)=   8.8750000000000000   5.7500000000000000   3.2500000000000000
 Testing find_grid_block
 Testing clean_grid
 Starting test_pass_cell
 test_pass_cell middle node= 14
 test_pass_cell
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14     -1      0   -100   -100      0     30      2      2      2   -100     28     29
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      1      1      0     14      0     30      3      2      2     14   -100   -100
     29      1      1      1      1      0     30      4      2      2     14   -100   -100
 nNode, nNodeUsed, nBlock= 29 28 14
 iNodeMorton_I = 1 2 3 4 5 6 7 8 9 10 11 12 13 28 29 15 16 17 18 19 20 21 22 23 24 25 26 27
 iMortonNode_A = 1 2 3 4 5 6 7 8 9 10 11 12 13 -100 16 17 18 19 20 21 22 23 24 25 26 27 28 14 15
 IsPeriodic_D = T T T
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= 0 0 0
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 7 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= 19 1 1 10
 testing message_pass_cell with nProlongOrder= 1  nCoarseLayer= 1  nWidth= 1
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= T
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= T
 testing message_pass_cell with nProlongOrder= 1  nCoarseLayer= 1  nWidth= 2
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= T
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= T
 testing message_pass_cell with nProlongOrder= 1  nCoarseLayer= 2  nWidth= 2
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= T
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= T
 testing message_pass_cell with nProlongOrder= 2  nCoarseLayer= 1  nWidth= 1
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= F
 testing message_pass_cell with nProlongOrder= 2  nCoarseLayer= 1  nWidth= 2
 testing message_pass_cell with DoSendCorner= F  DoRestrictFace= F
 testing message_pass_cell with DoSendCorner= T  DoRestrictFace= F
 Starting test_pass_face
 test_pass_face middle node= 14
 test_pass_face
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14     -1      0   -100   -100      0     30      2      2      2   -100     28     29
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      1      1      0     14      0     30      3      2      2     14   -100   -100
     29      1      1      1      1      0     30      4      2      2     14   -100   -100
 nNode, nNodeUsed, nBlock= 29 28 14
 iNodeMorton_I = 1 2 3 4 5 6 7 8 9 10 11 12 13 28 29 15 16 17 18 19 20 21 22 23 24 25 26 27
 iMortonNode_A = 1 2 3 4 5 6 7 8 9 10 11 12 13 -100 16 17 18 19 20 21 22 23 24 25 26 27 28 14 15
 IsPeriodic_D = T T T
 DiLevelNei_IIIB(:,0,0,First)= 0 0 0
 DiLevelNei_IIIB(0,:,0,First)= 0 0 0
 DiLevelNei_IIIB(0,0,:,First)= 0 0 0
 iNodeNei_IIIB(:,1,1,  First)= 3 1 1 2
 iNodeNei_IIIB(1,:,1,  First)= 7 1 1 4
 iNodeNei_IIIB(1,1,:,  First)= 19 1 1 10
 testing message_pass_face with DoResChangeOnly= T
 Starting test_amr
 after create_grid
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
 test prolong and balance
 after refine_tree_node
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1     -2      0      0      1      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      2      1      0      1      0     30      1      1      1      1   -100   -100
     29      2      1      0      1      0     30      2      1      1      1   -100   -100
 after distribute_tree(.false.)
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1     -2      0      0      1      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      2      1      0      1      0     30      1      1      1      1   -100   -100
     29      2      1      0      1      0     30      2      1      1      1   -100   -100
 iProc, iProcNew_A= 0 -100 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
 after do_amr
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1     -2      0      0      1      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      2      1      0     14      0     30      1      1      1      1   -100   -100
     29      2      1      0     15      0     30      2      1      1      1   -100   -100
 after move_tree
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1     -1      0   -100   -100      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28      1      1      0     14      0     30      1      1      1      1   -100   -100
     29      1      1      0     15      0     30      2      1      1      1   -100   -100
 iAmrChange_B= -1 0 0 0 0 0 0 0 0 0 0 0 0 2 2
 test restrict and balance
 after coarsen_tree_node
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      4      0   -100   -100      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28     -4      1      0     14      0     30      1      1      1      1   -100   -100
     29     -4      1      0     15      0     30      2      1      1      1   -100   -100
 after distribute_tree(.false.)
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      4      0   -100   -100      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28     -4      1      0     14      0     30      1      1      1      1   -100   -100
     29     -4      1      0     15      0     30      2      1      1      1   -100   -100
 iProc, iProcNew_A= 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 after do_amr
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      4      0      0      1      0     30      1      1      1   -100     28     29
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
     28     -4      1      0     14      0     30      1      1      1      1   -100   -100
     29     -4      1      0     15      0     30      2      1      1      1   -100   -100
 after move_tree
 iNode  Status Level  Proc   Block  MinLev MaxLev Coord1 Coord2 Coord3 Parent Child1 Child2
      1      1      0      0      1      0     30      1      1      1   -100   -100   -100
      2      1      0      0      2      0     30      2      1      1   -100   -100   -100
      3      1      0      0      3      0     30      3      1      1   -100   -100   -100
      4      1      0      0      4      0     30      1      2      1   -100   -100   -100
      5      1      0      0      5      0     30      2      2      1   -100   -100   -100
      6      1      0      0      6      0     30      3      2      1   -100   -100   -100
      7      1      0      0      7      0     30      1      3      1   -100   -100   -100
      8      1      0      0      8      0     30      2      3      1   -100   -100   -100
      9      1      0      0      9      0     30      3      3      1   -100   -100   -100
     10      1      0      0     10      0     30      1      1      2   -100   -100   -100
     11      1      0      0     11      0     30      2      1      2   -100   -100   -100
     12      1      0      0     12      0     30      3      1      2   -100   -100   -100
     13      1      0      0     13      0     30      1      2      2   -100   -100   -100
     14      1      0      1      1      0     30      2      2      2   -100   -100   -100
     15      1      0      1      2      0     30      3      2      2   -100   -100   -100
     16      1      0      1      3      0     30      1      3      2   -100   -100   -100
     17      1      0      1      4      0     30      2      3      2   -100   -100   -100
     18      1      0      1      5      0     30      3      3      2   -100   -100   -100
     19      1      0      1      6      0     30      1      1      3   -100   -100   -100
     20      1      0      1      7      0     30      2      1      3   -100   -100   -100
     21      1      0      1      8      0     30      3      1      3   -100   -100   -100
     22      1      0      1      9      0     30      1      2      3   -100   -100   -100
     23      1      0      1     10      0     30      2      2      3   -100   -100   -100
     24      1      0      1     11      0     30      3      2      3   -100   -100   -100
     25      1      0      1     12      0     30      1      3      3   -100   -100   -100
     26      1      0      1     13      0     30      2      3      3   -100   -100   -100
     27      1      0      1     14      0     30      3      3      3   -100   -100   -100
 iAmrChange_B= 3 0 0 0 0 0 0 0 0 0 0 0 0
